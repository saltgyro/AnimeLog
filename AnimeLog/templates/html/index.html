{% extends "html/base.html" %}
{% load static %}

{% block content %}
<button class="btn btn-primary m-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
    メニューを開く
</button>
<!-- オフキャンバスメニュー -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasExampleLabel">メニュー</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="閉じる"></button>
    </div>
    <div class="offcanvas-body">
        <ul class="list-unstyled">
            <li><a href="#" class="text-decoration-none">🎭 ジャンル</a></li>
                <li>
                    {% for genre in genres %}
                        <li>{{ genre.name }}</li>
                    {% endfor %}
                </li>
            <li><a href="#" class="text-decoration-none">🏷 タグ</a></li>
                <li>
                    {% for tag in tags %}
                        <li>{{ tag.name }}</li>
                    {% endfor %}
                </li>
            <li><a href="#" class="text-decoration-none">📅 年代</a></li>
                <li>
                    {% for season in seasons %}
                        <li>{{ season.year}} 年 {{season.get_season_display }}</li>
                    {% endfor %}
                </li>
            <li><a href="#" class="text-decoration-none">🎬 制作スタジオ</a></li>
                <li>
                    {% for studio in studios %}
                        <li>{{ studio.name }}</li>
                    {% endfor %}
                </li>
        </ul>
    </div>
</div>

<!-- ソートボタン -->
<div class="sort-options mb-3 d-flex justify-content-end">
    <label for="sort-select" class="form-label">並び順:</label>
    <select id="sort-select" class="form-select" onchange="applySort()">
        <option value="season-desc" {% if request.GET.sort == 'season-desc' %}{% endif %}>シーズン（新しい順）</option>
        <option value="season-asc" {% if request.GET.sort == 'season-asc' %}{% endif %}>シーズン（古い順）</option>
        <option value="average_rating" {% if request.GET.sort == 'average_rating' %}selected{% endif %}>人気順</option>
        <option value="watched_count-desc" {% if request.GET.sort == 'watched_count-desc' %}selected{% endif %}>登録数順</option>
    </select>
</div>

<div class="anime-list">
    {% for anime in animes %}
        <div class="anime-item">
            <a href="{% url 'anime_tracker:anime_detail' anime.id %}">
                {% if anime.thumbnail %}
                    <img src="{{ anime.thumbnail.url }}" alt="{{ anime.title }}" width="150">
                {% else %}
                    <p>画像なし</p>
                {% endif %}
                <p>{{ anime.title }}</p>
            </a>
        </div>
    {% endfor %}
</div>
{% endblock %}



