{% extends "html/base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/home.css' %}">

<div class="search-area">
<button id="offcanvas-toggle" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
    ‚Üí
</button>
<h6>Ê§úÁ¥¢Êù°‰ª∂</h6>
    <ul>
        <!-- „Éï„É™„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢ -->
        {% if search_conditions.search %}
        <strong>„Éï„É™„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢: 
            {% for keyword in search_conditions.search %}
                <span>{{ keyword }}
                </span>{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </strong>
        {% endif %}
        <!-- „Ç∏„É£„É≥„É´ -->
        {% if search_conditions.genre %}
            <strong>„Ç∏„É£„É≥„É´: 
                {% for genre in genres %}
                    {% if genre.id|stringformat:"s" in search_conditions.genre %}
                        <span>{{ genre.name }}
                        </span>
                    {% endif %}
                {% endfor %}
            </strong>
        {% endif %}
        <!-- „Çø„Ç∞ -->
        {% if search_conditions.tag %}
            <strong>„Çø„Ç∞: 
                {% for tag in tags %}
                    {% if tag.id|stringformat:"s" in search_conditions.tag %}
                        <span>{{ tag.name }}
                        </span>
                    {% endif %}
                {% endfor %}
            </strong>
        {% endif %}
        <!-- „Ç∑„Éº„Ç∫„É≥ -->
        {% if search_conditions.season %}
            <strong>„Ç∑„Éº„Ç∫„É≥: 
                {% for season in seasons %}
                    {% if season.id|stringformat:"s" in search_conditions.season %}
                        <span>{{ season.year }} Âπ¥ {{ season.get_season_display }}
                        </span>
                    {% endif %}
                {% endfor %}
            </strong>
        {% endif %}
        <!-- „Çπ„Çø„Ç∏„Ç™ -->
        {% if search_conditions.studio %}
            <strong>„Çπ„Çø„Ç∏„Ç™: 
                {% for studio in studios %}
                    {% if studio.id|stringformat:"s" in search_conditions.studio %}
                        <span>{{ studio.name }}
                        </span>
                    {% endif %}
                {% endfor %}
            </strong>
        {% endif %}
        <!-- 50Èü≥È†Ü - Êù°‰ª∂Ë°®Á§∫ -->
        {% if formatted_conditions %}
                <strong>50Èü≥È†Ü: 
                    <span>
                        {% for original, display in formatted_conditions.items %}
                        <span>{{ display }}</span>
                        {% endfor %}
                    </span>
                </strong>
            {% endif %}
    </ul>
</div>
<!-- „Ç™„Éï„Ç≠„É£„É≥„Éê„Çπ„É°„Éã„É•„Éº -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasExampleLabel">„É°„Éã„É•„Éº</h5>
        <div class="button-group">
            <button type="button" class="btn btn-primary confirm-filters"  style = "margin-right: 10px;"">Ê§úÁ¥¢„ÇíÂÆüË°å</button>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Èñâ„Åò„Çã"></button>
        </div>
    </div>
    <div class="offcanvas-body">
        <h6>Ê§úÁ¥¢Êù°‰ª∂</h6>
        <ul>
            <!-- „Éï„É™„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢ -->
            {% if search_conditions.search %}
            <li>„Éï„É™„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢: 
                {% for keyword in search_conditions.search %}
                    <span>{{ keyword }}
                        <button class="btn btn-sm btn-danger remove-condition" data-type="search" data-value="{{ keyword }}">√ó</button>
                    </span>{% if not forloop.last %} {% endif %}
                {% endfor %}
            </li>
            {% endif %}
            
            <!-- „Ç∏„É£„É≥„É´ -->
            {% if search_conditions.genre %}
                <li>„Ç∏„É£„É≥„É´: 
                    {% for genre in genres %}
                        {% if genre.id|stringformat:"s" in search_conditions.genre %}
                            <span>{{ genre.name }}
                                <button class="btn btn-sm btn-danger remove-condition" data-type="genre" data-value="{{ genre.id }}">√ó</button>

                            </span>
                        {% endif %}
                    {% endfor %}
                </li>
            {% endif %}

            <!-- „Çø„Ç∞ -->
            {% if search_conditions.tag %}
                <li>„Çø„Ç∞: 
                    {% for tag in tags %}
                        {% if tag.id|stringformat:"s" in search_conditions.tag %}
                            <span>{{ tag.name }}
                                <button class="btn btn-sm btn-danger remove-condition" data-type="tag" data-value="{{ tag.id }}">√ó</button>
                            </span>
                        {% endif %}
                    {% endfor %}
                </li>
            {% endif %}

            <!-- „Ç∑„Éº„Ç∫„É≥ -->
            {% if search_conditions.season %}
                <li>„Ç∑„Éº„Ç∫„É≥: 
                    {% for season in seasons %}
                        {% if season.id|stringformat:"s" in search_conditions.season %}
                            <span>{{ season.year }} Âπ¥ {{ season.get_season_display }}
                                <button class="btn btn-sm btn-danger remove-condition" data-type="season" data-value="{{ season.id }}">√ó</button>
                            </span>
                        {% endif %}
                    {% endfor %}
                </li>
            {% endif %}

            <!-- „Çπ„Çø„Ç∏„Ç™ -->
            {% if search_conditions.studio %}
                <li>„Çπ„Çø„Ç∏„Ç™: 
                    {% for studio in studios %}
                        {% if studio.id|stringformat:"s" in search_conditions.studio %}
                            <span>{{ studio.name }}
                                <button class="btn btn-sm btn-danger remove-condition" data-type="studio" data-value="{{ studio.id }}">√ó</button>
                            </span>
                        {% endif %}
                    {% endfor %}
                </li>
            {% endif %}

            <!-- 50Èü≥È†Ü - Êù°‰ª∂Ë°®Á§∫ -->
            {% if formatted_conditions %}
            <li>50Èü≥È†Ü: 
                <span>
                    {% for original, display in formatted_conditions.items %}
                    <span>{{ display }}
                        <button class="btn btn-sm btn-danger remove-condition" data-type="alphabet" data-value="{{ original }}">√ó</button>
                    </span>
                    {% endfor %}
                </span>
            </li>
            {% endif %}


        </ul>

        <!-- „É™„Çª„ÉÉ„Éà„Éú„Çø„É≥ -->
        <div class="offcanvas-footer">
            <button class="btn btn-danger m-3" id="reset-search">Ê§úÁ¥¢„É™„Çª„ÉÉ„Éà</button>
        </div>
        
        
        <label class="switch">
            <input type="checkbox" id="toggle-detail">
            <span class="slider">„Ç¢„Éã„É°Ë©≥Á¥∞ÊÉÖÂ†±„Çí‰∏ÄË¶ß„Å´Ë°®Á§∫„Åô„Çã</span>
        </label>
        
        <div style="height: 10px;"></div> <!-- Á©∫ÁôΩ„Çí‰Ωú„Çã„ÉÄ„Éü„ÉºË¶ÅÁ¥† -->
        <ul class="list-unstyled">
                <li>
                    <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#genreMenu" aria-expanded="false" aria-controls="genreMenu">
                        üé≠ „Ç∏„É£„É≥„É´
                    </a>
                
                    <!-- ‚úÖ Ê§úÁ¥¢Êù°‰ª∂ÔºàÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Çã„Ç∏„É£„É≥„É´Ôºâ„Çí‰∏ä„Å´Ë°®Á§∫Ôºà„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ‰ªò„ÅçÔºâ -->
                    <div id="selected-genres" class="selected-filters">
                        {% for genre in genres %}
                            {% if genre.id|stringformat:"s" in search_conditions.genre %}
                                <div class="form-check">
                                    <input 
                                        type="checkbox" 
                                        class="form-check-input genre-checkbox" 
                                        name="genre" 
                                        id="selected-genre-{{ genre.id }}" 
                                        value="{{ genre.id }}" 
                                        checked>
                                    <label class="form-check-label" for="selected-genre-{{ genre.id }}">{{ genre.name }}</label>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                
                    <!-- ‚úÖ Ê§úÁ¥¢Êù°‰ª∂„Å´„Å™„ÅÑ„ÇÇ„ÅÆÔºàÊú™ÈÅ∏Êäû„ÅÆ„Ç∏„É£„É≥„É´Ôºâ„Å†„Åë„ÇíË°®Á§∫ -->
                    <div id="genreMenu" class="collapse">
                        {% for genre in genres %}
                            {% if genre.id|stringformat:"s" not in search_conditions.genre %}
                                <div class="form-check">
                                    <input 
                                        type="checkbox" 
                                        class="form-check-input genre-checkbox" 
                                        name="genre" 
                                        id="genre-{{ genre.id }}" 
                                        value="{{ genre.id }}">
                                    <label class="form-check-label" for="genre-{{ genre.id }}">{{ genre.name }}</label>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                </li>
                

                <div style="height: 10px;"></div> <!-- Á©∫ÁôΩ„Çí‰Ωú„Çã„ÉÄ„Éü„ÉºË¶ÅÁ¥† -->

                <li>
                    <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#tagMenu" aria-expanded="false" aria-controls="tagMenu">
                        üè∑ „Çø„Ç∞
                    </a>
                
                    <!-- ‚úÖ Ê§úÁ¥¢Êù°‰ª∂ÔºàÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Çã„Çø„Ç∞Ôºâ„Çí„ÉÅ„Çß„ÉÉ„ÇØÊ∏à„Åø„ÅÆÁä∂ÊÖã„ÅßË°®Á§∫ -->
                    <div id="selected-tags" class="selected-filters">
                        {% for tag in tags %}
                            {% if tag.id|stringformat:"s" in search_conditions.tag %}
                                <div class="form-check">
                                    <input 
                                        type="checkbox" 
                                        class="form-check-input tag-checkbox" 
                                        name="tag" 
                                        id="selected-tag-{{ tag.id }}" 
                                        value="{{ tag.id }}" 
                                        checked>  <!-- ‚úÖ „Åì„Åì„Åß checked „ÇíËøΩÂä† -->
                                    <label class="form-check-label" for="selected-tag-{{ tag.id }}">{{ tag.name }}</label>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                
                    <!-- ‚úÖ Ê§úÁ¥¢Êù°‰ª∂„Å´„Å™„ÅÑ„ÇÇ„ÅÆÔºàÊú™ÈÅ∏Êäû„ÅÆ„Çø„Ç∞Ôºâ„Å†„Åë„ÇíË°®Á§∫ -->
                    <div id="tagMenu" class="collapse">
                        {% for tag in tags %}
                            {% if tag.id|stringformat:"s" not in search_conditions.tag %}
                                <div class="form-check">
                                    <input 
                                        type="checkbox" 
                                        class="form-check-input tag-checkbox" 
                                        name="tag" 
                                        id="tag-{{ tag.id }}" 
                                        value="{{ tag.id }}">
                                    <label class="form-check-label" for="tag-{{ tag.id }}">{{ tag.name }}</label>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                </li>

                <div style="height: 10px;"></div> <!-- Á©∫ÁôΩ„Çí‰Ωú„Çã„ÉÄ„Éü„ÉºË¶ÅÁ¥† -->
                
                <li>
                    <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#seasonMenu" aria-expanded="false" aria-controls="seasonMenu">üìÖ Âπ¥‰ª£</a>
                    <!-- ‚úÖ Ê§úÁ¥¢Êù°‰ª∂ÔºàÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Çã„Ç∑„Éº„Ç∫„É≥Ôºâ„Çí„ÉÅ„Çß„ÉÉ„ÇØÊ∏à„Åø„ÅÆÁä∂ÊÖã„ÅßË°®Á§∫ -->
                    <div id="selected-seasons" class="selected-filters">
                        {% for season_id, season_name in selected_seasons %}
                            {% if season_id|stringformat:"s" in search_conditions.season %}
                                <div class="form-check">
                                    <input 
                                        type="checkbox" 
                                        class="form-check-input season-checkbox" 
                                        name="season" 
                                        id="selected-season-{{ season_id }}" 
                                        value="{{ season_id }}" 
                                        checked>
                                    <label class="form-check-label" for="selected-season-{{ season_id }}">{{ season_name }}</label>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>




                    <div id="seasonMenu" class="collapse">
                        <ul>
                            <!-- 2025Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2025" aria-expanded="false" aria-controls="year-2025">
                                    2025Âπ¥
                                </a>
                                
                                
                            
                                <!-- ‚úÖ Ê§úÁ¥¢Êù°‰ª∂„Å´„Å™„ÅÑ„ÇÇ„ÅÆÔºàÊú™ÈÅ∏Êäû„ÅÆ„Ç∑„Éº„Ç∫„É≥Ôºâ„Å†„Åë„ÇíË°®Á§∫ -->
                                <div id="year-2025" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2025Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                </div>
                                
                            </li>
                            
                            <!-- 2024Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2024" aria-expanded="false" aria-controls="year-2024">
                                    2024Âπ¥
                                </a>
                                <div id="year-2024" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2024Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                </div>
                            </li>
                            <!-- 2023Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2023" aria-expanded="false" aria-controls="year-2023">
                                    2023Âπ¥
                                </a>
                                <div id="year-2023" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2023Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                </div>
                            </li>
                            <!-- 2022Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2022" aria-expanded="false" aria-controls="year-2022">
                                    2022Âπ¥
                                </a>
                                <div id="year-2022" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2022Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2021Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2021" aria-expanded="false" aria-controls="year-2021">
                                    2021Âπ¥
                                </a>
                                <div id="year-2021" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2021Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2020Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2020" aria-expanded="false" aria-controls="year-2020">
                                    2020Âπ¥
                                </a>
                                <div id="year-2020" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2020Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                </div>
                            </li>
                            <!-- 2019Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2019" aria-expanded="false" aria-controls="year-2019">
                                    2019Âπ¥
                                </a>
                                <div id="year-2019" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2019Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2018Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2018" aria-expanded="false" aria-controls="year-2018">
                                    2018Âπ¥
                                </a>
                                <div id="year-2018" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2018Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2017Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2017" aria-expanded="false" aria-controls="year-2017">
                                    2017Âπ¥
                                </a>
                                <div id="year-2017" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2017Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2016Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2016" aria-expanded="false" aria-controls="year-2016">
                                    2016Âπ¥
                                </a>
                                <div id="year-2016" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2016Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2015Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2015" aria-expanded="false" aria-controls="year-2015">
                                    2015Âπ¥
                                </a>
                                <div id="year-2015" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2015Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2014Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2014" aria-expanded="false" aria-controls="year-2014">
                                    2014Âπ¥
                                </a>
                                <div id="year-2014" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2014Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2013Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2013" aria-expanded="false" aria-controls="year-2013">
                                    2013Âπ¥
                                </a>
                                <div id="year-2013" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2013Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2012Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2012" aria-expanded="false" aria-controls="year-2012">
                                    2012Âπ¥
                                </a>
                                <div id="year-2012" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2012Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2011Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2011" aria-expanded="false" aria-controls="year-2011">
                                    2011Âπ¥
                                </a>
                                <div id="year-2011" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2011Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2010Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2010" aria-expanded="false" aria-controls="year-2010">
                                    2010Âπ¥
                                </a>
                                <div id="year-2010" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2010Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2009Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2009" aria-expanded="false" aria-controls="year-2009">
                                    2009Âπ¥
                                </a>
                                <div id="year-2009" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2009Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2008Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2008" aria-expanded="false" aria-controls="year-2008">
                                    2008Âπ¥
                                </a>
                                <div id="year-2008" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2008Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2007Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2007" aria-expanded="false" aria-controls="year-2007">
                                    2007Âπ¥
                                </a>
                                <div id="year-2007" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2006Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2006Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2006" aria-expanded="false" aria-controls="year-2006">
                                    2006Âπ¥
                                </a>
                                <div id="year-2006" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2006Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2005Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2005" aria-expanded="false" aria-controls="year-2005">
                                    2005Âπ¥
                                </a>
                                <div id="year-2005" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2005Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2004Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2004" aria-expanded="false" aria-controls="year-2004">
                                    2004Âπ¥
                                </a>
                                <div id="year-2004" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2004Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                            <!-- 2003Âπ¥ -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#year-2003" aria-expanded="false" aria-controls="year-2003">
                                    2003Âπ¥
                                </a>
                                <div id="year-2003" class="collapse">
                                    {% for season_id, season_name in unselected_seasons %}
                                        {% if "2003Âπ¥" in season_name %}
                                            <div class="form-check">
                                                <input 
                                                    type="checkbox" 
                                                    class="form-check-input season-checkbox" 
                                                    name="season" 
                                                    id="season-{{ season_id }}" 
                                                    value="{{ season_id }}"
                                                    {% if season_id|stringformat:"s" in search_conditions.season %}checked{% endif %}>  
                                                <label class="form-check-label" for="season-{{ season_id }}">{{ season_name }}</label>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                    <div style="height: 10px;"></div>
                                    
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>

                <div style="height: 10px;"></div> <!-- Á©∫ÁôΩ„Çí‰Ωú„Çã„ÉÄ„Éü„ÉºË¶ÅÁ¥† -->

                <li>
                    <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#studioMenu" aria-expanded="false" aria-controls="studioMenu">
                        üé¨ Âà∂‰Ωú„Çπ„Çø„Ç∏„Ç™
                    </a>
                
                    <!-- ‚úÖ Ê§úÁ¥¢Êù°‰ª∂ÔºàÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„ÇãÂà∂‰Ωú„Çπ„Çø„Ç∏„Ç™Ôºâ„Çí„ÉÅ„Çß„ÉÉ„ÇØÊ∏à„Åø„ÅÆÁä∂ÊÖã„ÅßË°®Á§∫ -->
                    <div id="selected-studios" class="selected-filters">
                        {% for studio in studios %}
                            {% if studio.id|stringformat:"s" in search_conditions.studio %}
                                <div class="form-check">
                                    <input 
                                        type="checkbox" 
                                        class="form-check-input studio-checkbox" 
                                        name="studio" 
                                        id="selected-studio-{{ studio.id }}" 
                                        value="{{ studio.id }}" 
                                        checked>  <!-- ‚úÖ „Åì„Åì„Åß checked „ÇíËøΩÂä† -->
                                    <label class="form-check-label" for="selected-studio-{{ studio.id }}">{{ studio.name }}</label>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                
                    <!-- ‚úÖ Ê§úÁ¥¢Êù°‰ª∂„Å´„Å™„ÅÑ„ÇÇ„ÅÆÔºàÊú™ÈÅ∏Êäû„ÅÆÂà∂‰Ωú„Çπ„Çø„Ç∏„Ç™Ôºâ„Å†„Åë„ÇíË°®Á§∫ -->
                    <div id="studioMenu" class="collapse">
                        <input type="text" id="studio-search" placeholder="„Çπ„Çø„Ç∏„Ç™„ÇíÊ§úÁ¥¢">
                        <div id="studio-list">
                            {% for studio in studios %}
                                {% if studio.id|stringformat:"s" not in search_conditions.studio %}
                                    <div class="form-check">
                                        <input 
                                            type="checkbox" 
                                            class="form-check-input studio-checkbox" 
                                            name="studio" 
                                            id="studio-{{ studio.id }}" 
                                            value="{{ studio.id }}">
                                        <label class="form-check-label" for="studio-{{ studio.id }}">{{ studio.name }}</label>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </li>
                
                <div style="height: 10px;"></div> <!-- Á©∫ÁôΩ„Çí‰Ωú„Çã„ÉÄ„Éü„ÉºË¶ÅÁ¥† -->
                
                <li>
                    <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#alphabetMenu" aria-expanded="false" aria-controls="alphabetMenu">üî§ 50Èü≥È†Ü</a>
                

                    {% if selected_alphabet %}
                        {% for data, display in selected_alphabet %}
                            <div class="form-check">
                                <input 
                                    type="radio" 
                                    class="form-check-input" 
                                    name="alphabet" 
                                    id="alphabet-{{ data }}" 
                                    value="{{ data }}"
                                    checked>
                                <label class="form-check-label" for="alphabet-{{ data }}">
                                    {{ display }}</label>
                            </div>
                        {% endfor %}
                    {% endif %}


                    <div id="alphabetMenu" class="collapse">
                        <!-- ÈÅ∏ÊäûÊ∏à„Åø„ÅÆ50Èü≥„Åå„ÅÇ„ÇãÂ†¥Âêà„Å´Ë°®Á§∫ -->
                        <!-- 50Èü≥È†Ü„Éï„Ç£„É´„Çø„ÉºÔºàÈÅ∏ÊäûÊ∏à„Åø„ÅÆ„ÅøË°®Á§∫Ôºâ -->
                        

                        <ul>
                            <!-- „ÅÇË°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-a" aria-expanded="false" aria-controls="row-a">„ÅÇË°å</a>
                                <div id="row-a" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        {% if unselected_alphabets.„ÅÇË°å %}
                                        <div>
                                            {% for data, display in unselected_alphabets.„ÅÇË°å %}
                                                <div class="form-check">
                                                    <input 
                                                        type="radio" 
                                                        class="form-check-input" 
                                                        name="alphabet" 
                                                        id="alphabet-{{ data }}" 
                                                        value="{{ data }}">
                                                    <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                        {% endif %}

                                    </ul>
                                </div>
                            </li>
                            <!-- „ÅãË°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-ka" aria-expanded="false" aria-controls="row-ka">„ÅãË°å</a>
                                <div id="row-ka" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        <div id="row-ka" class="collapse">
                                            <ul style="padding-left: 0; margin-left: 0;">
                                                {% if unselected_alphabets.„ÅãË°å %}
                                                <div>
                                                    {% for data, display in unselected_alphabets.„ÅãË°å %}
                                                        <div class="form-check">
                                                            <input 
                                                                type="radio" 
                                                                class="form-check-input" 
                                                                name="alphabet" 
                                                                id="alphabet-{{ data }}" 
                                                                value="{{ data }}">
                                                            <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                        </div>
                                                    {% endfor %}
                                                </div>
                                                {% endif %}
        
                                            </ul>
                                        </div>
                                    </ul>
                                    
                                </div>
                            </li>
                            <!-- „ÅïË°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-sa" aria-expanded="false" aria-controls="row-sa">„ÅïË°å</a>
                                <div id="row-sa" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        {% if unselected_alphabets.„ÅïË°å %}
                                        <div>
                                            {% for data, display in unselected_alphabets.„ÅïË°å %}
                                                <div class="form-check">
                                                    <input 
                                                        type="radio" 
                                                        class="form-check-input" 
                                                        name="alphabet" 
                                                        id="alphabet-{{ data }}" 
                                                        value="{{ data }}">
                                                    <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    {% endif %}

                                    </ul>
                                    
                                </div>
                            </li>
                            <!-- „ÅüË°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-ta" aria-expanded="false" aria-controls="row-ta">„ÅüË°å</a>
                                <div id="row-ta" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        {% if unselected_alphabets.„ÅüË°å %}
                                        <div>
                                            {% for data, display in unselected_alphabets.„ÅüË°å %}
                                                <div class="form-check">
                                                    <input 
                                                        type="radio" 
                                                        class="form-check-input" 
                                                        name="alphabet" 
                                                        id="alphabet-{{ data }}" 
                                                        value="{{ data }}">
                                                    <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    {% endif %}

                                    </ul>
                                    
                                </div>
                            </li>
                            <!-- „Å™Ë°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-na" aria-expanded="false" aria-controls="row-na">„Å™Ë°å</a>
                                <div id="row-na" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        {% if unselected_alphabets.„Å™Ë°å %}
                                        <div>
                                            {% for data, display in unselected_alphabets.„Å™Ë°å %}
                                                <div class="form-check">
                                                    <input 
                                                        type="radio" 
                                                        class="form-check-input" 
                                                        name="alphabet" 
                                                        id="alphabet-{{ data }}" 
                                                        value="{{ data }}">
                                                    <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </ul>
                                    
                                </div>
                            </li>
                            <!-- „ÅØË°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-ha" aria-expanded="false" aria-controls="row-ha">„ÅØË°å</a>
                                <div id="row-ha" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        {% if unselected_alphabets.„ÅØË°å %}
                                        <div>
                                            {% for data, display in unselected_alphabets.„ÅØË°å %}
                                                <div class="form-check">
                                                    <input 
                                                        type="radio" 
                                                        class="form-check-input" 
                                                        name="alphabet" 
                                                        id="alphabet-{{ data }}" 
                                                        value="{{ data }}">
                                                    <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </ul>
                                    
                                </div>
                            </li>
                            <!-- „ÅæË°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-ma" aria-expanded="false" aria-controls="row-ma">„ÅæË°å</a>
                                <div id="row-ma" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        {% if unselected_alphabets.„ÅæË°å %}
                                        <div>
                                            {% for data, display in unselected_alphabets.„ÅæË°å %}
                                                <div class="form-check">
                                                    <input 
                                                        type="radio" 
                                                        class="form-check-input" 
                                                        name="alphabet" 
                                                        id="alphabet-{{ data }}" 
                                                        value="{{ data }}">
                                                    <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </ul>
                                    
                                </div>
                            </li>
                            <!-- „ÇÑË°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-ya" aria-expanded="false" aria-controls="row-ya">„ÇÑË°å</a>
                                <div id="row-ya" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        {% if unselected_alphabets.„ÇÑË°å %}
                                        <div>
                                            {% for data, display in unselected_alphabets.„ÇÑË°å %}
                                                <div class="form-check">
                                                    <input 
                                                        type="radio" 
                                                        class="form-check-input" 
                                                        name="alphabet" 
                                                        id="alphabet-{{ data }}" 
                                                        value="{{ data }}">
                                                    <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </ul>
                                    
                                </div>
                            </li>
                            <!-- „ÇâË°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-ra" aria-expanded="false" aria-controls="row-ra">„ÇâË°å</a>
                                <div id="row-ra" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        {% if unselected_alphabets.„ÇâË°å %}
                                        <div>
                                            {% for data, display in unselected_alphabets.„ÇâË°å %}
                                                <div class="form-check">
                                                    <input 
                                                        type="radio" 
                                                        class="form-check-input" 
                                                        name="alphabet" 
                                                        id="alphabet-{{ data }}" 
                                                        value="{{ data }}">
                                                    <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </ul>
                                    
                                </div>
                            </li>
                            <!-- „ÇèË°å -->
                            <li>
                                <a href="#" class="text-decoration-none" data-bs-toggle="collapse" data-bs-target="#row-wa" aria-expanded="false" aria-controls="row-wa">„ÇèË°å</a>
                                <div id="row-wa" class="collapse">
                                    <ul style="padding-left: 0; margin-left: 0;">
                                        {% if unselected_alphabets.„ÇèË°å %}
                                        <div>
                                            {% for data, display in unselected_alphabets.„ÇèË°å %}
                                                <div class="form-check">
                                                    <input 
                                                        type="radio" 
                                                        class="form-check-input" 
                                                        name="alphabet" 
                                                        id="alphabet-{{ data }}" 
                                                        value="{{ data }}">
                                                    <label class="form-check-label" for="alphabet-{{ data }}">{{ display }}</label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </ul>
                                    
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
        </ul>
    </div>
</div>

    

<div class="filters">
    <a href="{% url 'anime_tracker:home' %}?status=not_in_list" 
    class="btn btn-primary filter-btn {% if request.GET.status != 'watched' and request.GET.status != 'favorite' and request.GET.status != 'plan_to_watch' %}selected{% endif %}">
    ÂÖ®‰ΩúÂìÅ
    </a>
    
    {% if request.user.is_authenticated %}
        <a href="{% url 'anime_tracker:home' %}?status=watched" 
        class="btn btn-primary filter-btn {% if request.GET.status == 'watched' %}selected{% endif %}">
        Ë¶ñËÅ¥Ê∏à„Åø
        </a>
        <a href="{% url 'anime_tracker:home' %}?status=favorite" 
        class="btn btn-primary filter-btn {% if request.GET.status == 'favorite' %}selected{% endif %}">
        „ÅäÊ∞ó„Å´ÂÖ•„Çä
        </a>
        <a href="{% url 'anime_tracker:home' %}?status=plan_to_watch" 
        class="btn btn-primary filter-btn {% if request.GET.status == 'plan_to_watch' %}selected{% endif %}">
        Ë¶ñËÅ¥‰∫àÂÆö
        </a>
    {% else %}
        <!-- Êú™„É≠„Ç∞„Ç§„É≥ÊôÇ„ÅØ„Éú„Çø„É≥„ÇíÁÑ°ÂäπÂåñ -->
        <div class="tooltip-container">
            <a class="btn btn-secondary disabled" aria-disabled="true" tabindex="-1">
            Ë¶ñËÅ¥Ê∏à„Åø
            </a>
            <span class="tooltip-text">„É≠„Ç∞„Ç§„É≥„Åô„Çã„Å®‰ΩøÁî®„Åß„Åç„Åæ„Åô</span>
        </div>
        <div class="tooltip-container">
            <a class="btn btn-secondary disabled" aria-disabled="true" tabindex="-1">
            „ÅäÊ∞ó„Å´ÂÖ•„Çä
            </a>
            <span class="tooltip-text">„É≠„Ç∞„Ç§„É≥„Åô„Çã„Å®‰ΩøÁî®„Åß„Åç„Åæ„Åô</span>
        </div>
        <div class="tooltip-container">
            <a class="btn btn-secondary disabled" aria-disabled="true" tabindex="-1">
            Ë¶ñËÅ¥‰∫àÂÆö
            </a>
            <span class="tooltip-text">„É≠„Ç∞„Ç§„É≥„Åô„Çã„Å®‰ΩøÁî®„Åß„Åç„Åæ„Åô</span>
        </div>
    {% endif %}
</div>



<!-- „ÇΩ„Éº„Éà„Éú„Çø„É≥ -->
<div class="sort-options">
    <label for="sort-select" class="form-label">‰∏¶„Å≥È†Ü:</label>
    <div style="margin-right: 30px;">
        <select id="sort-select" class="form-select" onchange="applySort()">
            <option value="season-desc" {% if request.GET.sort == 'season-desc' %}selected{% endif %}>„Ç∑„Éº„Ç∫„É≥ÔºàÊñ∞„Åó„ÅÑÈ†ÜÔºâ</option>
            <option value="season-asc" {% if request.GET.sort == 'season-asc' %}selected{% endif %}>„Ç∑„Éº„Ç∫„É≥ÔºàÂè§„ÅÑÈ†ÜÔºâ</option>
            <option value="average_rating" {% if request.GET.sort == 'average_rating' %}selected{% endif %}>‰∫∫Ê∞óÈ†Ü</option>
            <option value="watched_count-desc" {% if request.GET.sort == 'watched_count-desc' %}selected{% endif %}>„É¶„Éº„Ç∂„ÉºË¶ñËÅ¥Êï∞È†Ü</option>
            <option value="alphabet" {% if request.GET.sort == 'alphabet' %}selected{% endif %}>50Èü≥È†Ü</option>
        </select>
    </div>
</div>

<div class="search-results">
    <div class="anime-list">
        {% for anime in page_obj %}
            <div class="anime-item">
                <a href="{% url 'anime_tracker:anime_detail' anime.id %}?{{ request.GET.urlencode }}">
                    {% if anime.thumbnail %}
                        <img src="{{ anime.thumbnail.url }}" alt="{{ anime.title }}" width="150">
                    {% else %}
                        <p>ÁîªÂÉè„Å™„Åó</p>
                    {% endif %}
                    <p>{{ anime.title }}</p>
                </a>

                <div class="anime-detail" style="display: none;"> 
                    <table class="table table-striped">
                        <tbody>
                            <tr>
                                <th>ÊîæÈÄÅ<br>ÈñãÂßãÊó•</th>
                                <td style="width: 60px;"> {{ anime.start_date|date:"YÂπ¥" }}<br>
                                    {{ anime.start_date|date:"nÊúàjÊó•" }}</td>
                            </tr>
                            {% if anime.end_date %}
                            <tr>
                                <th>ÊîæÈÄÅ<br>ÁµÇ‰∫ÜÊó•</th>
                                <td style="width: 60px;">{{ anime.start_date|date:"YÂπ¥" }}<br>
                                    {{ anime.start_date|date:"nÊúàjÊó•" }}</td>
                            </tr>
                            {% endif %}
                            {% if anime.episode_count > 0 %}
                            <tr>
                                <th>Á∑èË©±Êï∞</th>
                                <td>{{ anime.episode_count }}</td>
                            </tr>
                            {% endif %}
                            <tr>
                                <th>Âπ≥ÂùáË©ï‰æ°</th>
                                <td>{{ anime.average_rating }}</td>
                            </tr>
                            <tr>
                                <th>Ë¶ñËÅ¥Ê∏à„Åø„É¶„Éº„Ç∂„ÉºÊï∞</th>
                                <td>{{ anime.watched_count }}</td>
                            </tr>
                            <tr>
                                <th>„ÅäÊ∞ó„Å´ÂÖ•„ÇäÊï∞</th>
                                <td>{{ anime.favorite_count }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
            </div>
        {% empty %}
            <p>Ë©≤ÂΩì„Åô„Çã„Ç¢„Éã„É°„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
        {% endfor %}
    </div>
    
    
    <!-- „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ -->
    <div class="pagination">
        <!-- ÊúÄÂàù„ÅÆ„Éö„Éº„Ç∏„Å∏„ÅÆ„É™„É≥„ÇØ -->
        {% if page_obj.has_previous %}
            <a href="?page=1{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" class="first-page">¬´</a>
            <a href="?page={{ page_obj.previous_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" class="prev-page">ÔºúÂâç„ÅÆ„Éö„Éº„Ç∏</a>
        {% endif %}
    
        <!-- „Éö„Éº„Ç∏Áï™Âè∑„ÅÆ„É´„Éº„Éó -->
        {% for num in page_obj.paginator.page_range %}
            {% if num == page_obj.number %}
                <span class="page-number active">{{ num }}</span>
            {% else %}
                <a href="?page={{ num }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" class="page-number">{{ num }}</a>
            {% endif %}
        {% endfor %}
    
        <!-- Ê¨°„ÅÆ„Éö„Éº„Ç∏„Å∏„ÅÆ„É™„É≥„ÇØ -->
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" class="next-page">Ê¨°„ÅÆ„Éö„Éº„Ç∏Ôºû</a>
            <a href="?page={{ page_obj.paginator.num_pages }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" class="last-page">¬ª</a>
        {% endif %}
    </div>
    
</div>


<script>
    

    document.addEventListener("DOMContentLoaded", function () {
        const detailToggleButton = document.getElementById("toggle-detail");
        const animeDetails = document.querySelectorAll('.anime-detail');
    
        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„Å´`sessionStorage`„Åã„ÇâÁä∂ÊÖã„ÇíÂèñÂæó„Åó„Å¶Âæ©ÂÖÉ
        const savedState = sessionStorage.getItem('detailToggleState'); // Áä∂ÊÖã„ÇíÂèñÂæó
        if (savedState === 'true') {
            detailToggleButton.checked = true; // „ÉÅ„Çß„ÉÉ„ÇØ„ÇíÂæ©ÂÖÉ
            animeDetails.forEach(detail => detail.style.display = 'block'); // Ë©≥Á¥∞ÊÉÖÂ†±„ÇíË°®Á§∫
        } else {
            detailToggleButton.checked = false; // „ÉÅ„Çß„ÉÉ„ÇØ„ÇíÂ§ñ„Åô
            animeDetails.forEach(detail => detail.style.display = 'none'); // Ë©≥Á¥∞ÊÉÖÂ†±„ÇíÈùûË°®Á§∫
        }
    
        // „Éà„Ç∞„É´„Éú„Çø„É≥„ÅÆÁä∂ÊÖã„ÅåÂ§âÊõ¥„Åï„Çå„Åü„Å®„Åç„ÅÆÂá¶ÁêÜ
        detailToggleButton.addEventListener("change", function () {
            const isChecked = detailToggleButton.checked; // ÁèæÂú®„ÅÆÁä∂ÊÖã„ÇíÂèñÂæó
            sessionStorage.setItem('detailToggleState', isChecked); // Áä∂ÊÖã„Çí‰øùÂ≠ò
            animeDetails.forEach(detail => {
                detail.style.display = isChecked ? 'block' : 'none'; // Áä∂ÊÖã„Å´Âøú„Åò„Å¶Ë°®Á§∫/ÈùûË°®Á§∫
            });
        });
    });
    
    
    document.addEventListener("DOMContentLoaded", function() {
        // ÂÖ®„Å¶„ÅÆ "remove-condition" „Éú„Çø„É≥„Å´„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„ÇíËøΩÂä†
        const buttons = document.querySelectorAll(".remove-condition");
        buttons.forEach(button => {
            button.addEventListener("click", function(event) {
                event.preventDefault(); // „Éá„Éï„Ç©„É´„Éà„ÅÆ„É™„É≥„ÇØÂãï‰Ωú„ÇíÈò≤„Åê
                

                // „Éú„Çø„É≥„Åã„ÇâÊù°‰ª∂„Çø„Ç§„Éó„Å®ÂÄ§„ÇíÂèñÂæó
                const type = this.getAttribute("data-type");
                const value = this.getAttribute("data-value");

                // ÁèæÂú®„ÅÆURL„ÇíÂèñÂæó„Åó„Å¶„ÇØ„Ç®„É™„Éë„É©„É°„Éº„Çø„ÇíÊìç‰Ωú
                const url = new URL(window.location.href);
                const params = url.searchParams;

                // „Éá„Éê„ÉÉ„Ç∞Áî®„É≠„Ç∞
                console.log("„ÇØ„É™„ÉÉ„ÇØ„Åï„Çå„Åü„Çø„Ç§„Éó:", type);
                console.log("„ÇØ„É™„ÉÉ„ÇØ„Åï„Çå„ÅüÂÄ§:", value);
                console.log("ÁèæÂú®„ÅÆ„Éë„É©„É°„Éº„Çø:", [...params.entries()]);

                // Ë©≤ÂΩì„Åô„ÇãÊù°‰ª∂„ÇíÂâäÈô§
                if (type === "search") {
                    // search Áî®„ÅÆÁâπÂà•Âá¶ÁêÜ
                    const currentSearch = params.get(type) || "";
                    console.log(`ÁèæÂú®„ÅÆÊ§úÁ¥¢„ÇØ„Ç®„É™: ${currentSearch}`);
                    
                    // ÂÖ®Ëßí„Çπ„Éö„Éº„Çπ„ÇíÂçäËßí„Çπ„Éö„Éº„Çπ„Å´ÁΩÆÊèõ
                    const normalizedSearch = currentSearch.replace(/\u3000/g, " ");
                    console.log(`Ê≠£Ë¶èÂåñÂæå„ÅÆÊ§úÁ¥¢„ÇØ„Ç®„É™: ${normalizedSearch}`);

                    // ÂçäËßí„Çπ„Éö„Éº„Çπ„ÅßÂàÜÂâ≤
                    const keywords = normalizedSearch.split(" ");
                    console.log(`ÂàÜÂâ≤„Åï„Çå„Åü„Ç≠„Éº„ÉØ„Éº„Éâ: ${keywords}`);
                    
                    // ÂâäÈô§ÂØæË±°„ÇíÈô§Â§ñ
                    const updatedKeywords = keywords.filter(keyword => keyword !== value);
                    console.log(`ÂâäÈô§Âæå„ÅÆ„Ç≠„Éº„ÉØ„Éº„Éâ: ${updatedKeywords}`);
                    if (updatedKeywords.length > 0) {
                        params.set(type, updatedKeywords.join(" "));
                    } else {
                        params.delete(type);
                    }
                } else {
                    // ÈÄöÂ∏∏„ÅÆÂá¶ÁêÜ
                    const values = params.getAll(type);
                    params.delete(type);
                    values.forEach(val => {
                        if (val !== value) {
                            params.append(type, val);
                        }
                    });
                }
                

                console.log("Â§âÊõ¥Âæå„ÅÆ„Éë„É©„É°„Éº„Çø:", [...params.entries()]);

                // ÈÅ∑Áßª„Çí‰∏ÄÊôÇÂÅúÊ≠¢
                console.log("„É™„ÉÄ„Ç§„É¨„ÇØ„ÉàÂÖàURL:", url.toString());
                
                event.stopImmediatePropagation(); // ‰ªñ„ÅÆ„É™„Çπ„Éä„Éº„ÇíÂÅúÊ≠¢
                // Êñ∞„Åó„ÅÑURL„Å´„É™„ÉÄ„Ç§„É¨„ÇØ„Éà
                
                window.location.href = url.toString();
            });
        });
    });
    
    
// ‚Üì„ÅåÊ§úÁ¥¢Ê©üËÉΩ
const selectedConditions = {}; // Ê§úÁ¥¢Êù°‰ª∂„Çí‰øùÂ≠ò„Åô„Çã„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà


document.addEventListener('DOMContentLoaded', () => {
    // Ê§úÁ¥¢„ÇíÂÆüË°å„Éú„Çø„É≥Ôºà„Åô„Åπ„Å¶„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥Ôºâ„Å´„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö
    document.querySelectorAll('.confirm-filters').forEach(button => {
        button.addEventListener('click', () => {
            const currentUrl = new URL(window.location.href);
            const params = currentUrl.searchParams;

            // ÂÖ®Êù°‰ª∂„Çí„É™„Çª„ÉÉ„Éà
            ['genre', 'tag', 'season', 'studio', 'alphabet'].forEach(type => params.delete(type));

            // ÂêÑÊù°‰ª∂„ÇíÂÜçÂèéÈõÜ
            ['genre', 'tag', 'season', 'studio', 'alphabet'].forEach(type => {
                const selectedValues = Array.from(
                    document.querySelectorAll(`input[name="${type}"]:checked`)
                ).map(checkbox => checkbox.value);

                // URL„Éë„É©„É°„Éº„Çø„Å´ËøΩÂä†
                selectedValues.forEach(value => params.append(type, value));
            });

            // Êñ∞„Åó„ÅÑURL„Å´ÈÅ∑Áßª
            currentUrl.search = params.toString();
            window.location.href = currentUrl.toString();
        });
    });
    // Ê§úÁ¥¢„É™„Çª„ÉÉ„Éà„Éú„Çø„É≥„ÇíÂèñÂæó
    document.getElementById('reset-search').addEventListener('click', () => {
        // ÁèæÂú®„ÅÆURL„ÇíÂèñÂæó
        let currentUrl = new URL(window.location.href);
        
        // URL„Éë„É©„É°„Éº„Çø„ÇíÂâäÈô§
        currentUrl.searchParams.delete('genre');
        currentUrl.searchParams.delete('tag');
        currentUrl.searchParams.delete('season');
        currentUrl.searchParams.delete('studio');
        currentUrl.searchParams.delete('status');
        currentUrl.searchParams.delete('sort');
        currentUrl.searchParams.delete('search');
        currentUrl.searchParams.delete('alphabet');

        // „É™„Çª„ÉÉ„Éà„Åó„ÅüURL„Å´ÈÅ∑Áßª
        window.location.href = currentUrl.toString();  // „Éö„Éº„Ç∏ÈÅ∑Áßª
    });
});


// ‚Üë„ÅåÊ§úÁ¥¢Ê©üËÉΩ

document.getElementById('studio-search').addEventListener('input', function () {
    const query = this.value.toLowerCase();
    const studios = document.querySelectorAll('#studio-list .form-check');
    studios.forEach(studio => {
        const name = studio.querySelector('label').textContent.toLowerCase();
        studio.style.display = name.includes(query) ? 'block' : 'none';
    });
});

// ‰ª•‰∏ã„ÅåÊ§úÁ¥¢„Éê„ÉºÊäº„Åï„Çå„ÅüÊôÇ„Å´‰ªñ„ÅÆÊ§úÁ¥¢Êù°‰ª∂‰øùÊåÅ„Åô„ÇãÂãï‰Ωú
document.addEventListener('DOMContentLoaded', function() {
    const searchForm = document.getElementById('search-form');
    searchForm.addEventListener('submit', function(e) {
        e.preventDefault(); // „Éá„Éï„Ç©„É´„Éà„ÅÆ„Éï„Ç©„Éº„É†ÈÄÅ‰ø°„ÇíÈò≤„Åê

        // ÁèæÂú®„ÅÆURL„ÇíÂèñÂæó
        const url = new URL(window.location.href);
        const params = url.searchParams;

        // „Éï„É™„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢„ÇíË®≠ÂÆö
        const searchInput = document.querySelector('input[name="search"]').value;
        params.set('search', searchInput);

        // Êñ∞„Åó„ÅÑURL„Å´„É™„ÉÄ„Ç§„É¨„ÇØ„Éà
        window.location.href = `${url.pathname}?${params.toString()}`;
    });
});


</script>
{% endblock %}


<style>
<!--

    
    
-->
</style>